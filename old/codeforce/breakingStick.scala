package scalaAlgo

object breakingStick {
  def longestSequence(a: Array[Long]): Long =  {
        //  Return the length of the longest possible sequence of moves.
    val arr:List[Tuple2[Long, Long]] = List((1, 1), (2, 3), (3, 4), (4, 7), (5, 6), (6, 10), (7, 8), (8, 15), (9, 13), (10, 16), (11, 12), (12, 22), (13, 14), (14, 22), (15, 21), (16, 31), (17, 18), (18, 31), (19, 20), (20, 36), (21, 29), (22, 34), (23, 24), (24, 46), (25, 31), (26, 40), (27, 40), (28, 50), (29, 30), (30, 51), (31, 32), (32, 63), (33, 45), (34, 52), (35, 43), (36, 67), (37, 38), (38, 58), (39, 53), (40, 76), (41, 42), (42, 71), (43, 44), (44, 78), (45, 66), (46, 70), (47, 48), (48, 94), (49, 57), (50, 81), (51, 69), (52, 92), (53, 54), (54, 94), (55, 67), (56, 106), (57, 77), (58, 88), (59, 60), (60, 111), (61, 62), (62, 94), (63, 92), (64, 127), (65, 79), (66, 111), (67, 68), (68, 120), (69, 93), (70, 113), (71, 72), (72, 139), (73, 74), (74, 112), (75, 106), (76, 134), (77, 89), (78, 131), (79, 80), (80, 156), (81, 121), (82, 124), (83, 84), (84, 155), (85, 103), (86, 130), (87, 117), (88, 166), (89, 90), (90, 156), (91, 105), (92, 162), (93, 125), (94, 142), (95, 115), (96, 190), (97, 98), (98, 155), (99, 144), (100, 181), (101, 102), (102, 171), (103, 104), (104, 196), (105, 148), (106, 160), (107, 108), (108, 202), (109, 110), (110, 177), (111, 149), (112, 218), (113, 114), (114, 191), (115, 139), (116, 204), (117, 170), (118, 178), (119, 137), (120, 231), (121, 133), (122, 184), (123, 165), (124, 218), (125, 156), (126, 218), (127, 128), (128, 255), (129, 173), (130, 209), (131, 132), (132, 243), (133, 153), (134, 202), (135, 201), (136, 256), (137, 138), (138, 231), (139, 140), (140, 253), (141, 189), (142, 214), (143, 157), (144, 283), (145, 175), (146, 220), (147, 204), (148, 260), (149, 150), (150, 256), (151, 152), (152, 286), (153, 222), (154, 243), (155, 187), (156, 287), (157, 158), (158, 238), (159, 213), (160, 316), (161, 185), (162, 283), (163, 164), (164, 288), (165, 232), (166, 250), (167, 168), (168, 323), (169, 183), (170, 273), (171, 248), (172, 302), (173, 174), (174, 291), (175, 218), (176, 342), (177, 237), (178, 268), (179, 180), (180, 336), (181, 182), (182, 287), (183, 245), (184, 346), (185, 223), (186, 311), (187, 205), (188, 330), (189, 281), (190, 305), (191, 192), (192, 382), (193, 194), (194, 292), (195, 274), (196, 351), (197, 198), (198, 342), (199, 200), (200, 381), (201, 269), (202, 304), (203, 233), (204, 375), (205, 247), (206, 310), (207, 300), (208, 404), (209, 229), (210, 358), (211, 212), (212, 372), (213, 285), (214, 322), (215, 259), (216, 418), (217, 249), (218, 328), (219, 293), (220, 397), (221, 239), (222, 371), (223, 224), (224, 442), (225, 331), (226, 340), (227, 228), (228, 419), (229, 230), (230, 369), (231, 320), (232, 436), (233, 234), (234, 404), (235, 283), (236, 414), (237, 317), (238, 375), (239, 240), (240, 471), (241, 242), (242, 375), (243, 364), (244, 428), (245, 302), (246, 411), (247, 267), (248, 466), (249, 333), (250, 406), (251, 252), (252, 470), (253, 277), (254, 382), (255, 358), (256, 511), (257, 258), (258, 431), (259, 297), (260, 469), (261, 378), (262, 394), (263, 264), (264, 507), (265, 319), (266, 419), (267, 357), (268, 470), (269, 270), (270, 471), (271, 272), (272, 528), (273, 378), (274, 412), (275, 342), (276, 507), (277, 278), (278, 418), (279, 404), (280, 533), (281, 282), (282, 471), (283, 284), (284, 498), (285, 400), (286, 443), (287, 329), (288, 571), (289, 307), (290, 465), (291, 389), (292, 512), (293, 294), (294, 498), (295, 355), (296, 556), (297, 441), (298, 448), (299, 323), (300, 556), (301, 345), (302, 454), (303, 405), (304, 590), (305, 367), (306, 528), (307, 308), (308, 551), (309, 413), (310, 497), (311, 312), (312, 599), (313, 314), (314, 472), (315, 463), (316, 554), (317, 318), (318, 531), (319, 349), (320, 636), (321, 429), (322, 507), (323, 343), (324, 607), (325, 404), (326, 490), (327, 437), (328, 616), (329, 377), (330, 562), (331, 332), (332, 582), (333, 482), (334, 502), (335, 403), (336, 659), (337, 338), (338, 521), (339, 453), (340, 613), (341, 373), (342, 590), (343, 400), (344, 646), (345, 484), (346, 520), (347, 348), (348, 639), (349, 350), (350, 568), (351, 521), (352, 694), (353, 354), (354, 591), (355, 427), (356, 624), (357, 494), (358, 538), (359, 360), (360, 696), (361, 381), (362, 544), (363, 496), (364, 651), (365, 439), (366, 611), (367, 368), (368, 714), (369, 534), (370, 593), (371, 425), (372, 683), (373, 374), (374, 579), (375, 531), (376, 706), (377, 407), (378, 659), (379, 380), (380, 685), (381, 509), (382, 574), (383, 384), (384, 766), (385, 474), (386, 580), (387, 560), (388, 680), (389, 390), (390, 664), (391, 415), (392, 743), (393, 525), (394, 592), (395, 475), (396, 738), (397, 398), (398, 598), (399, 552), (400, 781), (401, 402), (402, 671), (403, 435), (404, 708), (405, 606), (406, 639), (407, 445), (408, 783), (409, 410), (410, 657), (411, 549), (412, 722), (413, 473), (414, 714), (415, 499), (416, 820), (417, 557), (418, 647), (419, 420), (420, 778), (421, 422), (422, 634), (423, 612), (424, 796), (425, 528), (426, 711), (427, 489), (428, 750), (429, 586), (430, 689), (431, 432), (432, 850), (433, 434), (434, 683), (435, 610), (436, 764), (437, 461), (438, 731), (439, 440), (440, 837), (441, 645), (442, 681), (443, 444), (444, 815), (445, 535), (446, 670), (447, 597), (448, 890), (449, 450), (450, 781), (451, 493), (452, 792), (453, 605), (454, 682), (455, 560), (456, 875), (457, 458), (458, 688), (459, 681), (460, 829), (461, 462), (462, 782), (463, 464), (464, 900), (465, 652), (466, 700), (467, 468), (468, 872), (469, 537), (470, 753), (471, 629), (472, 886), (473, 517), (474, 791), (475, 590), (476, 851), (477, 690), (478, 718), (479, 480), (480, 951), (481, 519), (482, 724), (483, 668), (484, 859), (485, 583), (486, 850), (487, 488), (488, 916), (489, 653), (490, 792), (491, 492), (492, 903), (493, 523), (494, 761), (495, 727), (496, 962), (497, 569), (498, 831), (499, 500), (500, 906), (501, 669), (502, 754), (503, 504), (504, 974), (505, 607), (506, 783), (507, 690), (508, 890), (509, 510), (510, 868), (511, 585), (512, 1023), (513, 761), (514, 772), (515, 619), (516, 947), (517, 565), (518, 815), (519, 693), (520, 989), (521, 522), (522, 900), (523, 524), (524, 918), (525, 743), (526, 790), (527, 559), (528, 1035), (529, 553), (530, 849), (531, 768), (532, 951), (533, 575), (534, 891), (535, 643), (536, 1006), (537, 717), (538, 808), (539, 628), (540, 1011), (541, 542), (542, 814), (543, 725), (544, 1072), (545, 655), (546, 924), (547, 548), (548, 960), (549, 794), (550, 892), (551, 581), (552, 1059), (553, 633), (554, 832), (555, 778), (556, 974), (557, 558), (558, 962), (559, 603), (560, 1093), (561, 766), (562, 844), (563, 564), (564, 1035), (565, 679), (566, 850), (567, 848), (568, 1066), (569, 570), (570, 970), (571, 572), (572, 1015), (573, 765), (574, 903), (575, 714), (576, 1147), (577, 578), (578, 885), (579, 773), (580, 1045), (581, 665), (582, 971), (583, 637), (584, 1096), (585, 859), (586, 880), (587, 588), (588, 1086), (589, 621), (590, 945), (591, 789), (592, 1148), (593, 594), (594, 1035), (595, 732), (596, 1044), (597, 797), (598, 921), (599, 600), (600, 1156), (601, 602), (602, 947), (603, 872), (604, 1058), (605, 738), (606, 1011), (607, 608), (608, 1198), (609, 842), (610, 977), (611, 659), (612, 1140), (613, 614), (614, 922), (615, 862), (616, 1167), (617, 618), (618, 1031), (619, 620), (620, 1117), (621, 921), (622, 934), (623, 713), (624, 1223), (625, 781), (626, 940), (627, 856), (628, 1100), (629, 667), (630, 1093), (631, 632), (632, 1186), (633, 845), (634, 952), (635, 763), (636, 1167), (637, 742), (638, 987), (639, 924), (640, 1276), (641, 642), (642, 1071), (643, 644), (644, 1151), (645, 904), (646, 989), (647, 648), (648, 1255), (649, 709), (650, 1054), (651, 900), (652, 1142), (653, 654), (654, 1091), (655, 787), (656, 1272), (657, 950), (658, 1035), (659, 660), (660, 1222), (661, 662), (662, 994), (663, 902), (664, 1246), (665, 818), (666, 1148), (667, 697), (668, 1170), (669, 893), (670, 1073), (671, 733), (672, 1331), (673, 674), (674, 1012), (675, 1006), (676, 1197), (677, 678), (678, 1131), (679, 777), (680, 1293), (681, 909), (682, 1055), (683, 684), (684, 1274), (685, 823), (686, 1086), (687, 917), (688, 1334), (689, 743), (690, 1174), (691, 692), (692, 1212), (693, 1013), (694, 1042), (695, 835), (696, 1335), (697, 739), (698, 1048), (699, 933), (700, 1268), (701, 702), (702, 1223), (703, 741), (704, 1398), (705, 988), (706, 1060), (707, 809), (708, 1299), (709, 710), (710, 1137), (711, 1028), (712, 1336), (713, 745), (714, 1208), (715, 872), (716, 1254), (717, 957), (718, 1078), (719, 720), (720, 1416), (721, 825), (722, 1103), (723, 965), (724, 1268), (725, 900), (726, 1222), (727, 728), (728, 1379), (729, 1093), (730, 1169), (731, 775), (732, 1343), (733, 734), (734, 1102), (735, 1037), (736, 1450), (737, 805), (738, 1272), (739, 740), (740, 1333), (741, 1008), (742, 1167), (743, 744), (744, 1427), (745, 895), (746, 1120), (747, 1080), (748, 1327), (749, 857), (750, 1281), (751, 752), (752, 1458), (753, 1005), (754, 1161), (755, 907), (756, 1415), (757, 758), (758, 1138), (759, 1036), (760, 1445), (761, 762), (762, 1271), (763, 873), (764, 1338), (765, 1123), (766, 1150), (767, 827), (768, 1534), (769, 770), (770, 1244), (771, 1029), (772, 1352), (773, 774), (774, 1334), (775, 962), (776, 1456), (777, 1074), (778, 1168), (779, 821), (780, 1444), (781, 853), (782, 1197), (783, 1161), (784, 1527), (785, 943), (786, 1311), (787, 788), (788, 1380), (789, 1053), (790, 1265), (791, 905), (792, 1530), (793, 855), (794, 1192), (795, 1114), (796, 1394), (797, 798), (798, 1350), (799, 847), (800, 1581), (801, 1158), (802, 1204), (803, 877), (804, 1475), (805, 990), (806, 1241), (807, 1077), (808, 1516), (809, 810), (810, 1416), (811, 812), (812, 1451), (813, 1085), (814, 1259), (815, 979), (816, 1599), (817, 861), (818, 1228), (819, 1197), (820, 1477), (821, 822), (822, 1371), (823, 824), (824, 1546), (825, 1167), (826, 1299), (827, 828), (828, 1542), (829, 830), (830, 1329), (831, 1109), (832, 1652), (833, 970), (834, 1391), (835, 1003), (836, 1483), (837, 1241), (838, 1258), (839, 840), (840, 1618), (841, 871), (842, 1264), (843, 1125), (844, 1478), (845, 1028), (846, 1458), (847, 980), (848, 1644), (849, 1133), (850, 1378), (851, 889), (852, 1563), (853, 854), (854, 1343), (855, 1255), (856, 1606), (857, 858), (858, 1444), (859, 860), (860, 1549), (861, 1190), (862, 1294), (863, 864), (864, 1714), (865, 1039), (866, 1300), (867, 1174), (868, 1551), (869, 949), (870, 1480), (871, 939), (872, 1636), (873, 1262), (874, 1335), (875, 1093), (876, 1607), (877, 878), (878, 1318), (879, 1173), (880, 1717), (881, 882), (882, 1527), (883, 884), (884, 1565), (885, 1240), (886, 1330), (887, 888), (888, 1703), (889, 1017), (890, 1425), (891, 1332), (892, 1562), (893, 941), (894, 1491), (895, 1075), (896, 1786), (897, 1220), (898, 1348), (899, 931), (900, 1681), (901, 955), (902, 1395), (903, 1248), (904, 1696), (905, 1087), (906, 1511), (907, 908), (908, 1590), (909, 1314), (910, 1470), (911, 912), (912, 1787), (913, 997), (914, 1372), (915, 1282), (916, 1604), (917, 1049), (918, 1599), (919, 920), (920, 1749), (921, 1229), (922, 1384), (923, 995), (924, 1706), (925, 1148), (926, 1390), (927, 1340), (928, 1828), (929, 930), (930, 1582), (931, 1084), (932, 1632), (933, 1245), (934, 1402), (935, 1140), (936, 1808), (937, 938), (938, 1475), (939, 1253), (940, 1693), (941, 942), (942, 1571), (943, 985), (944, 1830), (945, 1408), (946, 1463), (947, 948), (948, 1739), (949, 1023), (950, 1540), (951, 1269), (952, 1803), (953, 954), (954, 1644), (955, 1147), (956, 1674), (957, 1306), (958, 1438), (959, 1097), (960, 1911), (961, 993), (962, 1481), (963, 1392), (964, 1688), (965, 1159), (966, 1634), (967, 968), (968, 1827), (969, 1312), (970, 1553), (971, 972), (972, 1822), (973, 1113), (974, 1462), (975, 1379), (976, 1892), (977, 978), (978, 1631), (979, 1069), (980, 1772), (981, 1418), (982, 1474), (983, 984), (984, 1887), (985, 1183), (986, 1509), (987, 1364), (988, 1749), (989, 1033), (990, 1717), (991, 992), (992, 1954), (993, 1325), (994, 1563), (995, 1195), (996, 1827), (997, 998), (998, 1498), (999, 1481), (1000, 1906))
    def opt(n:Long):Long = {
      if(arr.filter(_._1 == n) != Nil) return arr.filter(_._1 == n).head._2
      if(isPrime(n, false, 2)) return n + 1
      else {
        val largestPrime = largestDivisiblePrime(n, n/2 + 1)
        if(largestPrime == n) return 2 * opt(n / 2) + 1
        else return largestPrime * opt(n / largestPrime) + 1
      }
    }
    
    def largestDivisiblePrime(n:Long, m:Long):Long = {
      if(m <= 1) n
      else {
        if(isPrime(m, false, 2) && n % m == 0) m
        else largestDivisiblePrime(n, m - 1)
      }
    }
    
    def isPrime(n:Long, b:Boolean, m:Long):Boolean = {
      if(b) !b
      else if(m > Math.sqrt(n) + 1) true
      else {
        isPrime(n, n%m == 0, m + 1)
      }
    }
    (0.toLong /: a) ((x, xs) => x + opt(xs))
  }

    def main(args: Array[String]) {
        val sc = new java.util.Scanner (System.in);
        var n = sc.nextInt();
        var a = new Array[Long](n);
        for(a_i <- 0 to n-1) {
           a(a_i) = sc.nextLong();
        }
        val result = longestSequence(a);
        println(result)
    }
    /*
    (1 to 1000).map(x => {
      print("(" + x + ", " + longestSequence(Array(x)) + "), ")
    })
    * */
}